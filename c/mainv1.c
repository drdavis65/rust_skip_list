#define JRSL_IMPLEMENTATION
#include "jrsl.h"

/* The probability to add a new level to the skip list*/
#define P 0.5f

/* A helper function used during the skip list's destruction */
void free_data(void *key, void *data) { free(data); }

void label_printer(void *key, void *data) {
  // Print the key:data format and capture how many characters were printed
  int printed_chars = printf("%d:%c", *(int*)key, *(char*)data);
  
  // Pad with spaces to make total width 6 characters
  printf("%*s", 6 - printed_chars, "");
}

int intcmp(const void *a, const void *b) {
    int ia = *(const int*)a;
    int ib = *(const int*)b;
    return (ia > ib) - (ia < ib);
}

int main() {

  skip_list_t skip_list;

  int keys[] =  {
                  1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,  14,  15,  16,  17,  18,  19,  20, 
                 21,  22,  23,  24,  25,  26,  27,  28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,  39,  40, 
                 41,  42,  43,  44,  45,  46,  47,  48,  49,  50,  51,  52,  53,  54,  55,  56,  57,  58,  59,  60, 
                 61,  62,  63,  64,  65,  66,  67,  68,  69,  70,  71,  72,  73,  74,  75,  76,  77,  78,  79,  80, 
                 81,  82,  83,  84,  85,  86,  87,  88,  89,  90,  91,  92,  93,  94,  95,  96,  97,  98,  99, 100, 
                101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 
                121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 
                141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 
                161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 
                181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 
                201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 
                221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 
                241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 
                261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 
                281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 
                301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 
                321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 
                341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 
                361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 
                381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 
                401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 
                421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 
                441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 
                461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 
                481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 
                501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 
                521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 
                541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 
                561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 
                581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600, 
                601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 612, 613, 614, 615, 616, 617, 618, 619, 620, 
                621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634, 635, 636, 637, 638, 639, 640, 
                641, 642, 643, 644, 645, 646, 647, 648, 649, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 660, 
                661, 662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 680, 
                681, 682, 683, 684, 685, 686, 687, 688, 689, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 700, 
                701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 
                721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 
                741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 
                761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 
                781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792, 793, 794, 795, 796, 797, 798, 799, 800, 
                801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815, 816, 817, 818, 819, 820, 
                821, 822, 823, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839, 840, 
                841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 
                861, 862, 863, 864, 865, 866, 867, 868, 869, 870, 871, 872, 873, 874, 875, 876, 877, 878, 879, 880, 
                881, 882, 883, 884, 885, 886, 887, 888, 889, 890, 891, 892, 893, 894, 895, 896, 897, 898, 899, 900, 
                901, 902, 903, 904, 905, 906, 907, 908, 909, 910, 911, 912, 913, 914, 915, 916, 917, 918, 919, 920, 
                921, 922, 923, 924, 925, 926, 927, 928, 929, 930, 931, 932, 933, 934, 935, 936, 937, 938, 939, 940, 
                941, 942, 943, 944, 945, 946, 947, 948, 949, 950, 951, 952, 953, 954, 955, 956, 957, 958, 959, 960, 
                961, 962, 963, 964, 965, 966, 967, 968, 969, 970, 971, 972, 973, 974, 975, 976, 977, 978, 979, 980, 
                981, 982, 983, 984, 985, 986, 987, 988, 989, 990, 991, 992, 993, 994, 995, 996, 997, 998, 999, 1000};

  char data[] = {
                'q', 't', 'w', 'h', 'y', 'x', 'f', 'n', 'l', 'x', 'm', 'j', 'q', 'e', 'z', 'h', 'm', 'e', 'h', 'n', 
                'h', 'n', 'k', 'g', 't', 'g', 'j', 'i', 'r', 'b', 'j', 'q', 'r', 'e', 'e', 't', 'v', 'g', 'k', 'o', 
                't', 'z', 'a', 'x', 'r', 'n', 'b', 'p', 'a', 's', 'i', 'b', 'c', 'p', 'j', 'n', 's', 'y', 'j', 'm', 
                'm', 'm', 'u', 'k', 'i', 'c', 's', 'd', 'f', 'r', 'w', 'f', 'q', 'i', 'y', 'c', 'k', 'h', 'r', 'a', 
                'w', 'u', 'd', 'i', 't', 'n', 'm', 'j', 'w', 'e', 'm', 'r', 'w', 'd', 'v', 'm', 'w', 'g', 'w', 'z', 
                'a', 'w', 'p', 'p', 'v', 'b', 'm', 'y', 'h', 'u', 'z', 'j', 'b', 'c', 'c', 'h', 'v', 'o', 'l', 'q', 
                'n', 'b', 'i', 'i', 'w', 'h', 'p', 'w', 'v', 'y', 'j', 'r', 'z', 'j', 'j', 'c', 'j', 'd', 'a', 'q', 
                'z', 'p', 'x', 'l', 'y', 'c', 's', 'k', 'z', 'w', 'j', 'n', 'j', 'e', 'p', 't', 'z', 'i', 'b', 't', 
                'v', 'q', 'u', 'i', 'e', 'd', 'q', 'a', 'i', 'i', 'v', 'w', 'n', 'o', 'w', 'l', 'z', 'u', 's', 'k', 
                'q', 'u', 'q', 'q', 'y', 'y', 'g', 'x', 'k', 'k', 'j', 'c', 'f', 's', 'o', 'o', 'z', 'b', 'v', 'w', 
                'p', 'q', 'z', 'w', 'h', 'z', 'z', 'v', 'e', 'i', 'o', 'v', 'd', 'y', 'p', 'b', 'z', 'f', 'k', 'a', 
                't', 'r', 'd', 'b', 'g', 'a', 'q', 'l', 'h', 't', 'p', 'n', 'y', 'q', 'k', 'x', 'j', 'h', 'w', 'n', 
                'a', 'q', 'h', 'x', 'e', 'a', 'z', 'd', 'd', 'b', 'x', 'm', 'l', 'm', 's', 'n', 't', 'u', 'q', 'j', 
                'w', 'g', 'y', 'n', 'p', 'r', 'f', 'i', 'w', 'y', 'y', 'g', 'x', 't', 'm', 'o', 's', 'm', 'f', 'o', 
                'r', 'm', 'r', 'i', 'n', 'x', 'k', 'h', 's', 'b', 'y', 'w', 'l', 'l', 'd', 'b', 'a', 'k', 't', 'f', 
                'r', 'z', 'k', 'o', 'l', 'v', 's', 'u', 'u', 'n', 'k', 'w', 'r', 'o', 'v', 'o', 't', 'h', 'c', 'e', 
                'k', 'b', 'u', 's', 'a', 'k', 'y', 'l', 'c', 'x', 'x', 'w', 'e', 'n', 'd', 'k', 'x', 'h', 'a', 'c', 
                'r', 'n', 'w', 'v', 'l', 'l', 'n', 'j', 'g', 'm', 't', 's', 'k', 'w', 'l', 'i', 'f', 'b', 'u', 't', 
                'h', 'y', 'i', 'e', 'e', 'o', 'w', 'a', 'p', 'x', 't', 'o', 'i', 'b', 'l', 'k', 'r', 'p', 'l', 'r', 
                'u', 'q', 'k', 'w', 'm', 'y', 'p', 'r', 'h', 'q', 'w', 'j', 'g', 'u', 'n', 'c', 'x', 'y', 'x', 'z', 
                'y', 'g', 'c', 'h', 's', 'e', 'w', 'i', 'g', 'w', 't', 'g', 'g', 'c', 'x', 'w', 'i', 'g', 'q', 'w', 
                'u', 'r', 'h', 'c', 'i', 'l', 'p', 'e', 'k', 't', 'b', 'c', 'p', 'k', 'r', 't', 'z', 'o', 'k', 'j', 
                's', 'l', 'l', 'w', 'y', 's', 't', 'x', 't', 'w', 'k', 'c', 'f', 's', 'u', 'u', 'y', 'm', 's', 'p', 
                'n', 'u', 'h', 's', 'h', 'h', 'c', 't', 'w', 'g', 's', 'p', 'l', 'p', 'c', 'k', 'v', 'g', 'b', 'v', 
                'z', 'g', 't', 'k', 'z', 'q', 'f', 't', 'a', 'q', 'x', 'p', 'k', 'b', 'v', 'q', 'b', 'j', 'r', 'l', 
                's', 'b', 'h', 'x', 'i', 's', 'n', 's', 'd', 'n', 'w', 'j', 'j', 'p', 'w', 'u', 'v', 'x', 'j', 'y', 
                'e', 'q', 'k', 'd', 'd', 'y', 'w', 'm', 'w', 'g', 'k', 'n', 'o', 'w', 'r', 'r', 's', 'v', 'd', 'v', 
                'j', 'r', 'b', 'g', 'q', 't', 'm', 'v', 'x', 'x', 'z', 't', 'e', 'v', 'o', 'w', 'r', 'f', 'e', 'a', 
                'y', 'r', 'c', 'x', 'y', 'q', 'v', 'n', 'h', 'p', 'b', 'o', 'f', 'g', 'n', 'w', 'n', 'z', 'n', 'x', 
                'z', 'm', 'r', 'w', 'b', 'o', 'd', 'p', 'f', 'k', 'm', 's', 'e', 'u', 'x', 'i', 'g', 'u', 'z', 'e', 
                'q', 't', 'r', 't', 'f', 'i', 'f', 's', 's', 'h', 'h', 's', 'u', 'r', 's', 'q', 'a', 'n', 'w', 'w', 
                'z', 'g', 'b', 'w', 'q', 'l', 'i', 'o', 'g', 'l', 'o', 'q', 'w', 'q', 'p', 's', 'n', 'a', 'v', 'k', 
                'h', 'y', 'p', 'p', 'f', 'r', 'z', 'd', 'j', 'o', 'z', 'e', 'd', 'p', 'm', 'd', 'z', 'n', 'y', 'n', 
                'n', 'e', 'e', 't', 'h', 'k', 'u', 'm', 'm', 't', 'o', 'a', 'b', 'h', 's', 'i', 'm', 'w', 'i', 'l', 
                'k', 'v', 'f', 't', 'p', 'd', 'i', 'h', 'y', 'e', 's', 'g', 'p', 'p', 'd', 'r', 'l', 'u', 's', 'h', 
                'i', 'p', 'o', 'n', 'v', 'i', 'u', 'k', 'd', 'h', 'k', 'b', 'm', 'j', 'g', 's', 'c', 'y', 'q', 'j', 
                'a', 'q', 'k', 'v', 'h', 'm', 'd', 'r', 'a', 'n', 'z', 'p', 'u', 'x', 'o', 'f', 'a', 't', 't', 'j', 
                's', 'v', 'j', 'g', 'k', 't', 'l', 'b', 'y', 'z', 'p', 'f', 'z', 'x', 'a', 'b', 'x', 'o', 'g', 'l', 
                't', 'v', 'l', 'h', 'k', 'j', 'j', 'i', 'z', 'v', 'i', 'b', 'h', 'r', 'b', 'k', 'i', 'g', 'z', 'l', 
                't', 'v', 't', 'd', 'd', 'q', 'x', 'e', 'g', 'j', 'i', 'z', 'w', 'z', 'j', 'x', 'm', 't', 'k', 'n', 
                'c', 'j', 'b', 'y', 'h', 'u', 'p', 'v', 'f', 'g', 'n', 'b', 'p', 'b', 'u', 'f', 't', 'w', 'a', 'i', 
                'g', 'j', 's', 'm', 'n', 'f', 'k', 'p', 's', 'r', 'f', 'v', 'x', 'g', 'k', 'n', 'l', 's', 'g', 'z', 
                'i', 'b', 'o', 'i', 'u', 'd', 'e', 's', 'b', 't', 'f', 'r', 'c', 'k', 'z', 'w', 'j', 'e', 'w', 'm', 
                'c', 'j', 'e', 'q', 'c', 'w', 'o', 'p', 's', 'q', 'l', 'q', 'd', 'q', 'd', 'x', 's', 'o', 'c', 'y', 
                'z', 't', 'g', 'l', 'f', 'v', 'p', 'r', 'x', 'w', 'i', 'k', 'k', 's', 'b', 'f', 'q', 't', 'd', 'y', 
                'c', 'f', 'w', 'b', 'o', 'l', 'o', 'u', 'y', 'c', 'e', 'i', 'w', 's', 'd', 'g', 'o', 'b', 'm', 'x', 
                'q', 'j', 't', 'x', 'e', 'v', 'h', 'f', 'p', 'd', 't', 'y', 'l', 'p', 'l', 'f', 'o', 'q', 'n', 't', 
                'r', 'b', 'v', 'l', 't', 'i', 'e', 'z', 'f', 'n', 'e', 'd', 'f', 'w', 'n', 'j', 'f', 'c', 'l', 'b', 
                'j', 'h', 'j', 'j', 'n', 'r', 'l', 'c', 'b', 'z', 'i', 'd', 'c', 'b', 'c', 'a', 'g', 'z', 'd', 'f', 
                'h', 's', 'q', 'c', 'j', 'm', 'x', 'l', 't', 'l', 's', 'b', 'g', 'l', 'm', 't', 'x', 'c', 'r', 'i'};

  size_t i; /* used in for loops */

  int keys2 [] = {
                372, 264, 448, 753, 150, 430, 717, 816, 558, 653, 844, 672, 45, 332, 765, 767, 390, 639, 616, 977, 
                787, 581, 795, 107, 994, 932, 691, 550, 1, 584, 283, 431, 967, 819, 292, 527, 699, 150, 663, 395, 
                205, 203, 541, 637, 971, 689, 73, 118, 474, 137, 755, 110, 113, 644, 404, 150, 726, 911, 265, 44, 
                225, 610, 672, 652, 121, 322, 234, 871, 806, 749, 624, 142, 451, 224, 974, 434, 716, 464, 787, 368, 
                594, 465, 746, 292, 635, 527, 875, 495, 436, 837, 129, 40, 243, 80, 658, 850, 657, 860, 178, 58, 
                270, 849, 466, 225, 160, 661, 857, 23, 878, 86, 415, 771, 998, 330, 395, 709, 639, 796, 286, 511, 
                988, 129, 11, 753, 534, 328, 618, 186, 624, 541, 890, 217, 728, 363, 348, 51, 347, 802, 647, 786, 
                550, 117, 318, 571, 352, 470, 851, 31, 565, 803, 731, 10, 206, 289, 24, 841, 102, 5, 848, 62, 
                520, 937, 279, 110, 611, 38, 653, 398, 335, 813, 88, 740, 63, 581, 324, 709, 927, 78, 110, 147, 
                586, 535, 775, 89, 422, 471, 61, 325, 277, 507, 842, 40, 86, 809, 940, 118, 321, 14, 466, 194, 
                873, 933, 875, 29, 696, 180, 358, 275, 90, 974, 921, 231, 180, 63, 603, 185, 769, 386, 721, 551, 
                218, 76, 852, 445, 775, 573, 187, 908, 495, 971, 984, 231, 447, 368, 608, 682, 971, 935, 196, 32, 
                427, 265, 833, 965, 991, 39, 295, 998, 584, 460};
  char data2 [] = {
                'p', 'm', 'j', 'x', 'z', 'u', 's', 'm', 't', 'q', 'k', 'c', 'z', 'u', 'n', 'b', 'n', 'r', 'h', 'u', 
                'm', 'k', 'f', 'm', 'h', 'a', 'j', 'g', 'e', 'q', 'z', 'r', 's', 'w', 'f', 'a', 'b', 't', 'n', 'd', 
                'x', 'h', 'c', 'd', 'o', 'i', 'x', 'l', 'm', 'r', 'k', 'h', 'v', 'v', 'k', 's', 'o', 'e', 's', 'z', 
                's', 'c', 'v', 'd', 'l', 'q', 'f', 'v', 'w', 's', 'g', 'g', 'p', 'n', 'i', 'q', 'p', 'b', 'o', 'f', 
                'a', 'w', 'm', 'p', 'p', 'o', 'x', 'f', 'm', 'g', 'k', 'o', 'c', 'n', 'u', 'o', 'l', 'x', 'v', 'i', 
                'u', 't', 's', 'u', 'l', 'j', 'n', 'x', 'p', 's', 't', 'y', 'm', 's', 'x', 'z', 'l', 'i', 'p', 'a', 
                'a', 'r', 'z', 'u', 'h', 'e', 's', 'y', 'a', 'n', 'y', 'b', 'h', 'e', 's', 'w', 'e', 'a', 'o', 'y', 
                'q', 'x', 'x', 't', 'a', 'h', 't', 'r', 'r', 'z', 'q', 'v', 'x', 'u', 'b', 's', 'm', 'l', 's', 'o', 
                'k', 'x', 'k', 'k', 'u', 'b', 'o', 'l', 'q', 'c', 't', 'x', 'y', 'b', 'a', 'w', 's', 'b', 'w', 'z', 
                'v', 'j', 'a', 'h', 'v', 'm', 'w', 'n', 'b', 'w', 'h', 'l', 'w', 'a', 'v', 'w', 'v', 'j', 'k', 'm', 
                'd', 's', 'f', 'j', 'n', 'c', 'u', 'u', 'n', 'q', 'b', 'y', 'h', 'g', 'a', 'j', 'd', 'p', 'f', 'r', 
                'l', 'i', 'm', 'w', 'b', 'e', 'i', 'y', 'z', 'm', 'e', 'q', 's', 'f', 'v', 'w', 'z', 'e', 'y', 'o', 
                'c', 's', 'u', 'k', 'h', 'f', 'q', 'r', 'e', 'v'};

  /* Let's initialize the skip list using jrsl_initialize, we will use a
   * probability of 0.5. We can use jrsl_max_level to determine the optimum
   * amount of levels knowing the maximum size of our list.*/

  printf("max level: %d\n", jrsl_max_level(1000, P));
  jrsl_initialize(&skip_list, (comparator_t)intcmp, free, P,
                  jrsl_max_level(1000, P));

  /* Insert all 1000 elements from the first dataset */
  for (i = 0; i < 1000; i++) {
    void *result = jrsl_insert(&skip_list, &keys[i], &data[i]);
    if (result) {
      printf("Inserted %d:%c -- Some('%c')\n", keys[i], data[i], *(char*)result);
    } else {
      printf("Inserted %d:%c -- None\n", keys[i], data[i]);
    }
  }

  /* Insert the second dataset */
  for (i = 0; i < 250; i++) {
    void *result = jrsl_insert(&skip_list, &keys2[i], &data2[i]);
    if (result) {
      printf("Inserted %d:%c -- Some('%c')\n", keys2[i], data2[i], *(char*)result);
    } else {
      printf("Inserted %d:%c -- None\n", keys2[i], data2[i]);
    }
  }

  /* Test removals */
  int removals[] = {
        798, 633, 846, 555, 15, 803, 516, 515, 480, 696, 308, 427, 781, 730, 406, 94, 55, 457, 712, 459, 398, 397, 305, 15, 188, 
        580, 597, 138, 765, 538, 697, 927, 267, 326, 773, 640, 611, 361, 775, 339, 116, 118, 814, 834, 936, 877, 118, 60, 345, 757, 
        730, 231, 965, 673, 941, 534, 628, 957, 572, 637, 488, 718, 144, 140, 68, 214, 460, 536, 222, 251, 993, 987, 766, 494, 303, 
        435, 179, 50, 624, 616, 472, 941, 24, 131, 794, 654, 831, 699, 488, 831, 882, 680, 128, 272, 654, 114, 56, 417, 535, 688, 
        318, 394, 278, 291, 980, 107, 324, 1000, 938, 221, 917, 697, 316, 278, 293, 638, 252, 180, 705, 306, 318, 856, 26, 232, 504, 
        47, 773, 568, 713, 73, 706, 844, 528, 398, 314, 1, 776, 939, 766, 222, 886, 665, 244, 702, 230, 457, 68, 696, 264, 182, 
        486, 43, 377, 392, 403, 781, 791, 865, 880, 191, 806, 780, 916, 512, 908, 165, 319, 933, 273, 257, 830, 109, 562, 672, 616, 
        418, 179, 830, 280, 179, 966, 662, 51, 469, 85, 906, 173, 732, 751, 390, 809, 907, 517, 793, 77, 193, 37, 796, 910, 11, 
        764, 79, 733, 111, 686, 5, 449, 12, 955, 935, 375, 980, 578, 172, 378, 564, 835, 45, 572, 72, 325, 232, 853, 962, 37, 
        524, 759, 585, 108, 316, 340, 909, 962, 270, 568, 107, 604, 569, 247, 510, 654, 297, 249, 891, 696, 211, 519, 225, 683, 105
  };

  for (i = 0; i < 250; i++) {
    void *removed_data = jrsl_remove(&skip_list, &removals[i]);
    if (removed_data) {
      printf("Removed: %d:%c\n", removals[i], *(char*)removed_data);
    } else {
      printf("Unable to remove %d, key not found\n", removals[i]);
    }
  }

  /* Test searches */
  int searches[] = {
    745, 398, 464, 757, 22, 33, 130, 438, 547, 719, 510, 759, 825, 931, 245, 811, 530, 539, 40, 601, 960, 764, 350, 219, 87, 
    685, 52, 927, 608, 39, 456, 430, 652, 405, 33, 443, 588, 874, 252, 249, 118, 466, 829, 817, 898, 808, 485, 719, 671, 695, 
    582, 119, 204, 711, 530, 49, 575, 126, 718, 120, 444, 932, 423, 185, 453, 144, 158, 979, 7, 301, 871, 515, 61, 211, 615, 
    580, 992, 815, 494, 942, 227, 211, 523, 946, 971, 633, 767, 91, 451, 379, 356, 538, 783, 300, 971, 232, 922, 124, 993, 647, 
    209, 691, 107, 167, 304, 263, 867, 961, 421, 884, 32, 587, 44, 41, 20, 853, 523, 373, 835, 327, 617, 691, 123, 592, 333, 
    818, 654, 386, 479, 859, 300, 938, 288, 279, 553, 594, 643, 106, 847, 546, 818, 492, 232, 846, 588, 806, 92, 973, 650, 150, 
    246, 420, 778, 756, 997, 742, 296, 190, 818, 424, 675, 368, 46, 525, 932, 659, 580, 524, 490, 872, 616, 54, 87, 413, 284, 
    936, 186, 645, 717, 491, 245, 538, 294, 961, 701, 422, 497, 436, 199, 402, 927, 46, 473, 737, 239, 159, 529, 731, 364, 314, 
    155, 272, 147, 411, 403, 850, 855, 769, 527, 753, 734, 729, 337, 997, 796, 187, 331, 344, 243, 684, 290, 335, 921, 450, 238, 
    471, 621, 553, 927, 713, 338, 252, 4, 338, 220, 71, 922, 999, 316, 491, 51, 731, 500, 172, 628, 816, 805, 757, 443, 539
  };

  for (i = 0; i < 250; i++) {
    void *found_data = jrsl_search(&skip_list, &searches[i]);
    if (found_data) {
      printf("Found %d: %c\n", searches[i], *(char*)found_data);
    } else {
      printf("Key %d not found\n", searches[i]);
    }
  }

  /* Test direct access by index */
  size_t list_size = skip_list.width;  /* Use .width instead of jrsl_size() */
  for (i = 0; i < list_size; i++) {
    void *key_ptr = jrsl_key_at(&skip_list, i);
    void *data_ptr = jrsl_data_at(&skip_list, i);
    if (key_ptr && data_ptr) {
      printf("Index %zu: key=%d, data=%c\n", i, *(int*)key_ptr, *(char*)data_ptr);
    }
  }

  /* Clean up */
  // jrsl_destroy(&skip_list, free_data);

  return 0;
}